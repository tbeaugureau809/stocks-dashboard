{% extends "base.html" %}

{% block content %}
    {% if error %}
    <div class="alert alert-danger" role = "alert">
        {{ error }}
    </div>
    {% endif %}
    <div class="container mt4">
        <h1 style="font-size: 24pt">Top Gains</h1>
        <table class = "table table-striped table-bordered">
            <thead>
                <tr>
                    <th>Symbol</th>
                    <th>Latest Price</th>
                    <th>Previous Close</th>
                    <th>% Change</th>
                    <th>As of (CST)</th>
                </tr>
            </thead>
            <tbody>
                {% for row in movers.top %}
                    {% if row %}
                        <tr>
                            <td>{{ row.symbol}}</td>
                            <td>${{ "%.2f" | format(row.latest) }}</td>
                            <td>${{ "%.2f" | format(row.previous_close) }}</td>
                            <td>{{ "%.2f" | format(row.percent_change) }}%</td>
                            <td>{{ row.last_updated.strftime("%d/%m/%Y, %H:%M:%S") if row.last_updated else "NA" }}
                                {% if row.stale %}
                                    <span class="badge bg-warning">STALE</span>
                                {% endif %}
                            </td>
                        </tr>
                    {% else %}
                        <tr>
                            <td colspan="5" class="text-danger text-center">No data available</td>
                        </tr>
                    {% endif %}
                {% endfor %}
            </tbody>
        </table>
        <h2 style="font-size: 24pt">Top Losers</h2>
        <table class = "table table-bordered table-striped">
            <thead>
                <tr>
                    <th>Symbol</th>
                    <th>Latest Price</th>
                    <th>Previous Close</th>
                    <th>% Change</th>
                    <th>As of (CST)</th>
                </tr>
            </thead>
            <tbody>
                {% for row in movers.bottom %}
                    {% if row %}
                        <tr>
                            <td>{{ row.symbol }}</td>
                            <td>${{"%.2f" | format(row.latest) }}</td>
                            <td>${{"%.2f" | format(row.previous_close) }}</td>
                            <td>{{"%.2f" | format(row.percent_change)}}%</td>
                            <td>{{ row.last_updated.strftime("%d/%m/%Y, %H:%M:%S") if row.last_updated else "NA" }}
                                {% if row.stale %}
                                    <span class ="badge bg-warning">STALE</span>
                                {% endif %}
                            </td>
                        </tr>
                    {% else %}
                        <tr>
                            <td colspan="5" class="text-danger text-center">No data available</td>
                        </tr>
                    {% endif %}
                {% endfor %}
            </tbody>
        </table>
    </div>
{% endblock %}
